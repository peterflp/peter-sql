## Ankit Bansal SQL

This folder contains solutions for **Complex SQL Questions** and **Medium Complex SQL Questions** from the *Ankit Bansal's* YouTube playlist.

Below is an index of the problems covered, with links to the corresponding video tutorials for easy reference.

**NOTE:** For some problems, the file name begins with the company name from whose interview the corresponding question was asked. This is not the case for all questions.

**Last updated on**: *March 24, 2025*

---

### Quick Navigation

- [Complex SQL Questions Index](#complex-sql-questions---playlist-link)

- [Medium Complex SQL Questions Index](#medium-complex-sql-questions---playlist-link)


---
---

### Complex SQL Questions - [Playlist Link](https://www.youtube.com/playlist?list=PLBTZqjSKn0IeKBQDjLmzisazhqQy4iGkb)

| Sr. No. | Problem / Video Title                                                                          | YouTube Video                                                   |
|---------|------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|
| 1       | [Derive points ICC tournament](./complex-sql-questions-playlist/01-derive-points-icc-tournament.md)                           | [Watch Video](https://www.youtube.com/watch?v=qyAgWL066Vo)      |
| 2       | [Find new & repeat customers](./complex-sql-questions-playlist/02-find-new-&-repeat-customers.md)                             | [Watch Video](https://www.youtube.com/watch?v=MpAMjtvarrc)      |
| 3       | [Employee visits & Resource Analysis](./complex-sql-questions-playlist/03-employee-visits-&-resource-analysis.md)             | [Watch Video](https://www.youtube.com/watch?v=P6kNMyqKD0A)      |
| 4       | [Nth occurrence of Sunday](./complex-sql-questions-playlist/04-nth-occurence-of-sunday.md)                                    | [Watch Video](https://www.youtube.com/watch?v=6XQAokp4UCs)      |
| 5       | [Pareto principle implementation](./complex-sql-questions-playlist/05-pareto-principle-implementation.md)                     | [Watch Video](https://www.youtube.com/watch?v=oGgE180oaTs)      |
| 6       | [Friends Info](./complex-sql-questions-playlist/06-friends-info.md)                                                           | [Watch Video](https://www.youtube.com/watch?v=SfzbR69LquU)      |
| 7       | [Trips & Users](./complex-sql-questions-playlist/07-trips-&-users.md)                                                         | [Watch Video](https://www.youtube.com/watch?v=EjzhMv0E_FE)      |
| 8       | [Tournaments Winner](./complex-sql-questions-playlist/08-tournaments-winner.md)                                               | [Watch Video](https://www.youtube.com/watch?v=IQ4n4n-Y9z8)      |
| 9       | [Market Analysis II](./complex-sql-questions-playlist/09-market-analysis-ii.md)                                               | [Watch Video](https://www.youtube.com/watch?v=1ias-sP_XAY)      |
| 10      | [Report Contiguous Dates](./complex-sql-questions-playlist/10-report-contiguous-dates.md)                                     | [Watch Video](https://www.youtube.com/watch?v=WrToXXN7Jb4)      |
| 11      | [User Purchase Platform](./complex-sql-questions-playlist/11-user-purchase-platform.md)                                       | [Watch Video](https://www.youtube.com/watch?v=4MLVfsQEGl0)      |
| 12      | [Total sales amount by year](./complex-sql-questions-playlist/12-total-sales-amount-by-year.md)                               | [Watch Video](https://www.youtube.com/watch?v=ewmEHQSQYRM)      |
| 13      | [Recommendation System](./complex-sql-questions-playlist/13-recommendation-system.md)                                         | [Watch Video](https://www.youtube.com/watch?v=9Kh7EnZlhUg)      |
| 14      | [Prime Subscription](./complex-sql-questions-playlist/14-prime-subscription.md)                                               | [Watch Video](https://www.youtube.com/watch?v=i_ljK9gmstY)      |
| 15      | [Customer Retention & Churn - Part 1](./complex-sql-questions-playlist/15-16-customer-retention-&-churn.md)                   | [Watch Video](https://www.youtube.com/watch?v=6hfsRqmyvog)      |
| 16      | [Customer Retention & Churn - Part 2](./complex-sql-questions-playlist/15-16-customer-retention-&-churn.md)                   | [Watch Video](https://www.youtube.com/watch?v=hGflhxWWxTI)      |
| 17      | [Second most recent Activity](./complex-sql-questions-playlist/17-second-most-recent-activity.md)                             | [Watch Video](https://www.youtube.com/watch?v=RljzVfz8vjk)      |
| 18      | [Billing Charges](./complex-sql-questions-playlist/18-billing-charges.md)                                                     | [Watch Video](https://www.youtube.com/watch?v=51ryMCf-fvU)      |
| 19      | [Spotify - Takehome Challenge](./complex-sql-questions-playlist/19-spotify-takehome-challenge.md)                               | [Watch Video](https://www.youtube.com/watch?v=-YdAIMjHZrM)      |
| 20      | [Consecutive Empty Seats](./complex-sql-questions-playlist/20-consecutive-empty-seats.md)                                    | [Watch Video](https://www.youtube.com/watch?v=F9Otofceer0)      |
| 21      | [Find Missing Quarter](./complex-sql-questions-playlist/21-find-missing-quarter.md)                                           | [Watch Video](https://www.youtube.com/watch?v=cGP5Tm2gVdQ)      |
| 24      | [Google - English German Users](./complex-sql-questions-playlist/24-google-english-german-users.md)                             | [Watch Video](https://www.youtube.com/watch?v=35gjU7pChQk)      |
| 25      | [Meesho - Customer Budget](./complex-sql-questions-playlist/25-meesho-customer-budget.md)                                     | [Watch Video](https://www.youtube.com/watch?v=B09xhslOvxw)      |
| 26      | [Amazon - Horizontal Sorting](./complex-sql-questions-playlist/26-amazon-horizontal-sorting.md)                                 | [Watch Video](https://www.youtube.com/watch?v=FZm7NgybHWA)      |
| 27      | [Student Performance Analysis](./complex-sql-questions-playlist/27-student-performance-analysis.md)                           | [Watch Video](https://www.youtube.com/watch?v=Ck1gQrlS5pQ)      |
| 28      | [Largest Order](./complex-sql-questions-playlist/28-largest-order.md)                                                         | [Watch Video](https://www.youtube.com/watch?v=e1SVjR-xoto)      |
| 29      | [On-Off Problem](./complex-sql-questions-playlist/29-on-off-problem.md)                                                       | [Watch Video](https://www.youtube.com/watch?v=XQ80MgsTka0)      |
| 30      | [Students Report by Geography](./complex-sql-questions-playlist/30-students-report-by-geography.md)                           | [Watch Video](https://www.youtube.com/watch?v=e-I9SxbLky8)      |
| 31      | [Median Employee Salary](./complex-sql-questions-playlist/31-median-employee-salary.md)                                       | [Watch Video](https://www.youtube.com/watch?v=fwPk1RXlorQ)      |
| 32      | [Third Highest Salary with Twist](./complex-sql-questions-playlist/32-third-highest-salary-with-twist.md)                     | [Watch Video](https://www.youtube.com/watch?v=Cbm6Hz_Yhwg)      |
| 33      | [Human Traffic of Stadium](./complex-sql-questions-playlist/33-human-traffic-of-stadium.md)                                   | [Watch Video](https://www.youtube.com/watch?v=tDfAo7uw-3w)      |
| 34      | [Udaan - New Cities Count](./complex-sql-questions-playlist/34-udaan-new-cities-count.md)                                       | [Watch Video](https://www.youtube.com/watch?v=y-CeVtidYJE)      |
| 35      | [Pharmeasy - Consecutive Seats](./complex-sql-questions-playlist/35-pharmeasy-consecutive-seats.md)                             | [Watch Video](https://www.youtube.com/watch?v=e4IILSHtKl4)      |
| 36      | [Bosch - Phone Numbers](./complex-sql-questions-playlist/36-bosch-phone-numbers.md)                                             | [Watch Video](https://www.youtube.com/watch?v=pk8BKFysjP8)      |
| 37      | [Cricket Analytics](./complex-sql-questions-playlist/37-cricket-analytics.md)                                                 | [Watch Video](https://www.youtube.com/watch?v=7LufPVm01NQ)      |
| 38      | [Deloitte - Last Not Null Value](./complex-sql-questions-playlist/38-deloitte-last-not-null-value.md)                           | [Watch Video](https://www.youtube.com/watch?v=Xh0EevUOWF0)      |
| 39      | [Find the quiet students in all exams](./complex-sql-questions-playlist/39-find-the-quiet-students-in-all-exams.md)           | [Watch Video](https://www.youtube.com/watch?v=6CH7IU4yB5I)      |
| 40      | [Walmart Labs - Call History](./complex-sql-questions-playlist/40-walmart-labs-call-history.md)                                 | [Watch Video](https://www.youtube.com/watch?v=3qEfsSC27_4)      |
| 41      | [Microsoft - Employee Hiring Budget](./complex-sql-questions-playlist/41-microsoft-employee-hiring-budget.md)                   | [Watch Video](https://www.youtube.com/watch?v=KLqRHJ-Eg2s)      |
| 42      | [Manager's Manager](./complex-sql-questions-playlist/42-managers-manager.md)                                                   | [Watch Video](https://www.youtube.com/watch?v=8glk10JlvKE)      |
| 43      | [Visa - Monthly Merchant Balance](./complex-sql-questions-playlist/43-visa-monthly-merchant-balance.md)                         | [Watch Video](https://www.youtube.com/watch?v=D2vqqOfVBuc)      |
| 44      | [Airbnb - Matching Rental Amenities](./complex-sql-questions-playlist/44-airbnb-matching-rental-amenities.md)                   | [Watch Video](https://www.youtube.com/watch?v=5O4Tx72-CKU)      |
| 45      | [Delta Records](./complex-sql-questions-playlist/45-delta-records.md)                                                         | [Watch Video](https://www.youtube.com/watch?v=QHwHS4AMmQM)      |
| 46      | [Uber - Driver Rides](./complex-sql-questions-playlist/46-uber-driver-rides.md)                                                 | [Watch Video](https://www.youtube.com/watch?v=eayyD51fIVY)      |
| 47      | [Amazon - Repeat Purchases](./complex-sql-questions-playlist/47-amazon-repeat-purchases.md)                                     | [Watch Video](https://www.youtube.com/watch?v=FNUIqQbj_EE)      |
| 48      | [Marketing Campaign Success](./complex-sql-questions-playlist/48-marketing-campaign-success.md)                               | [Watch Video](https://www.youtube.com/watch?v=m_oDI0bD6VQ)      |
| 49      | [Trade Price Difference](./complex-sql-questions-playlist/49-trade-price-difference.md)                                       | [Watch Video](https://www.youtube.com/watch?v=X6i1WMx0vnY)      |
| 50      | [Top Number from Sections](./complex-sql-questions-playlist/50-top-number-from-sections.md)                                   | [Watch Video](https://www.youtube.com/watch?v=ACD6J1opmFs)      |
| 51      | [Booking and User Segments](./complex-sql-questions-playlist/51-booking-and-user-segments.md)                                 | [Watch Video](https://www.youtube.com/watch?v=XsbqEx_3GiM)      |
| 52      | [Merge Overlapping events in the same hall](./complex-sql-questions-playlist/52-merge-overlapping-events-in-the-same-hall.md) | [Watch Video](https://www.youtube.com/watch?v=dX14FgKTpyg)      |
| 53      | [Paypal - Average Salary Comparison](./complex-sql-questions-playlist/53-paypal-average-salary-comparision.md)                  | [Watch Video](https://www.youtube.com/watch?v=UrIrBraLvZU)      |
| 54      | [Paypal - Employee Salary and Demand Summary](./complex-sql-questions-playlist/54-paypal-employee-salary-and-demand-summary.md) | [Watch Video](https://www.youtube.com/watch?v=u3W_Op3FTVA)      |
| 55      | [Uplers - Candidates Salary](./complex-sql-questions-playlist/55-uplers-candidates-salary.md)                                   | [Watch Video](https://www.youtube.com/watch?v=C9DGxJKBbb4)      |
| 56      | [Company Job Vacancies](./complex-sql-questions-playlist/56-company-job-vacancies.md)                                         | [Watch Video](https://www.youtube.com/watch?v=nCfaHbTVPXQ)      |
| 57      | [Cities with no Return Orders](./complex-sql-questions-playlist/57-cities-with-no-return-orders.md)                           | [Watch Video](https://www.youtube.com/watch?v=SRXogHD2btg)      |
| 58      | [Cities Visited](./complex-sql-questions-playlist/58-cities-visited.md)                                                       | [Watch Video](https://www.youtube.com/watch?v=XssFpKFSNFw)      |
| 59      | [Freshworks - Monthly Price Difference](./complex-sql-questions-playlist/59-freshworks-monthly-price-difference.md)             | [Watch Video](https://www.youtube.com/watch?v=MQXfhH1d8K0)      |
| 60      | [Business Intelligence Metrics](./complex-sql-questions-playlist/60-business-intelligence-metrics.md)                         | [Watch Video](https://www.youtube.com/watch?v=T8QXFwV7NIY)      |
| 61      | [Split Customer Name](./complex-sql-questions-playlist/61-split-customer_name.md)                                             | [Watch Video](https://www.youtube.com/watch?v=tVQUsozKkyI)      |
| 62      | [Gameberry Labs - Game Social Interaction](./complex-sql-questions-playlist/62-gameberry-labs-game-social-interaction.md)       | [Watch Video](https://www.youtube.com/watch?v=zYewZWQBGVU)      |
| 64      | [Swiggy - Consecutive Days Stock Quantity](./complex-sql-questions-playlist/64-swiggy-consecutive-days-stock-quantity.md)       | [Watch Video](https://www.youtube.com/watch?v=l72hohmWA68)      |
| 65      | [ITC Infotech - Remove Duplicates](./complex-sql-questions-playlist/65-itc-infotech-remove-duplicates.md)                       | [Watch Video](https://www.youtube.com/watch?v=JHUlQZrviCI)      |
| 66      | [Meesho - Monthly Increase COVID Cases](./complex-sql-questions-playlist/66-meesho-monthly-increase-covid-cases.md)             | [Watch Video](https://www.youtube.com/watch?v=W4t63Sj77N4)      |
| 67      | [Hackerrank - 15 Days of Learning SQL](./complex-sql-questions-playlist/67-hackerrank-15-days-of-learning-sql.md)               | [Watch Video](https://www.youtube.com/watch?v=zrCIWGHnLao)      |
| 68      | [Fractal - Game of Thrones](./complex-sql-questions-playlist/68-fractal-game-of-thrones.md)                                     | [Watch Video](https://www.youtube.com/watch?v=QFZG-IHC8xk)      |
| 69      | [Complete Case Study](./complex-sql-questions-playlist/69-complete-case-study.md)                                             | [Watch Video](https://www.youtube.com/watch?v=5kbuhoEw1Xg)      |
| 70      | [Tredence - Consecutive Available Seats](./complex-sql-questions-playlist/70-tredence-consecutive-available-seats.md)           | [Watch Video](https://www.youtube.com/watch?v=V7KFQD0PIj8)      |
| 71      | [Amex - Page Recommendation](./complex-sql-questions-playlist/71-amex-page-recommendation.md)                                   | [Watch Video](https://www.youtube.com/watch?v=aGKzhAkkOP8)      |
| 72      | [Acies - Employee Login-Logout](./complex-sql-questions-playlist/72-acies-employee-login-logout.md)                             | [Watch Video](https://www.youtube.com/watch?v=Jo2Ra41QQcU)      |
| 73      | [Amazon - Prime Subscription](./complex-sql-questions-playlist/73-amazon-prime-subscription.md)                                 | [Watch Video](https://www.youtube.com/watch?v=hZEc6m_HPTs)      |
| 74      | [Zepto - Integer Repetition](./complex-sql-questions-playlist/74-zepto-integer-repetition.md)                                   | [Watch Video](https://www.youtube.com/watch?v=xS6iq3d8Eb4&t=7s) |
| 75      | [Probo - Poll Investment Redistribution](./complex-sql-questions-playlist/75-probo-poll-investment-redistribution.md)                                   | [Watch Video](https://www.youtube.com/watch?v=xS6iq3d8Eb4&t=7s) |
| 76      | [Postgres Regex Expressions](./complex-sql-questions-playlist/76-postgres-regex-expressions.md)                                   | [Watch Video](https://www.youtube.com/watch?v=gx2giIxFplY) |
| 77      | [Seekho - User Session Activity](./complex-sql-questions-playlist/77-seekho-user-session-activity.md)                                   | [Watch Video](https://www.youtube.com/watch?v=B7sTTafjXcg) |
| 78      | [IPL Data Analysis](./complex-sql-questions-playlist/78-ipl-data-analysis.md)                                   | [Watch Video](https://www.youtube.com/watch?v=lGjfOkPcePk) |
| 79      | [Epam - Candidates Experience](./complex-sql-questions-playlist/79-epam-candidates-experience.md)                                   | [Watch Video](https://www.youtube.com/watch?v=rsnA8mMbRPQ) |
| 80      | [Google - Top 5 Sellers-Buyers Combinations](./complex-sql-questions-playlist/80-google-top-5-seller-buyer-combinations.md)                                   | [Watch Video](https://www.youtube.com/watch?v=2wN3D0jsj9k) |

---

### Medium Complex SQL Questions - [Playlist Link](https://www.youtube.com/playlist?list=PLBTZqjSKn0IfuIqbMIqzS-waofsPHMS0E)


| Sr. No. | Problem / Video Title                                                                          | YouTube Video                                                   |
|---------|------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|
| 1       | [Olympics Gold Medals](./medium-complex-sql-questions-playlist/01-olympics-gold-medals.md)           | [Watch Video](https://www.youtube.com/watch?v=dOLBRfwzYcU)      |
| 2       | [Find Business Days](./medium-complex-sql-questions-playlist/02-find-business-days.md)               | [Watch Video](https://www.youtube.com/watch?v=FZ0GCcnIIWA)      |
| 3       | [Amazon - People Inside Hospital](./medium-complex-sql-questions-playlist/03-amazon-people-inside-hospital.md) | [Watch Video](https://www.youtube.com/watch?v=oGYinDMDfnA)      |
| 4       | [Airbnb - Convert CSV to Rows](./medium-complex-sql-questions-playlist/04-airbnb-convert-csv-to-rows.md) | [Watch Video](https://www.youtube.com/watch?v=PE5MZW1CxOI)      |
| 5       | [EPAM Systems - Employee Salaries](./medium-complex-sql-questions-playlist/05-epam-systems-employee-salaries.md) | [Watch Video](https://www.youtube.com/watch?v=TvqKpz9RO-A)      |
| 6       | [LinkedIn - Power Creators](./medium-complex-sql-questions-playlist/06-linkedin-power-creators.md)    | [Watch Video](https://www.youtube.com/watch?v=TLE-xW9rZfQ)      |
| 7       | [Adobe - Photoshop Revenue Analysis](./medium-complex-sql-questions-playlist/07-photoshop-revenue-analysis.md) | [Watch Video](https://www.youtube.com/watch?v=TgKmfAV2pw8)      |
| 8       | [Amazon - Join Based Problem](./medium-complex-sql-questions-playlist/08-amazon-join-based-problem.md) | [Watch Video](https://www.youtube.com/watch?v=D1MW6Z3PNbA)      |
| 9       | [Stitch Fix - Repeat Purchases on Multiple Days](./medium-complex-sql-questions-playlist/09-repeat-purchases-on-multiple-days.md) | [Watch Video](https://www.youtube.com/watch?v=TGxgo3tu400)      |
| 10      | [Spotify - Top 5 Artists](./medium-complex-sql-questions-playlist/10-spotify-top-5-artists.md)        | [Watch Video](https://www.youtube.com/watch?v=DwYAz9hYjrw)      |
| 11      | [L&T - Highest & Lowest Salary](./medium-complex-sql-questions-playlist/11-l&t-highest-lowest-salary.md) | [Watch Video](https://www.youtube.com/watch?v=7W7B0y5WsaQ)      |
| 12      | [Call Start & End Time](./medium-complex-sql-questions-playlist/12-call-start-end-time.md)          | [Watch Video](https://www.youtube.com/watch?v=lxFQ0RgyEcA)      |
| 13      | [Infosys - SQL Puzzle](./medium-complex-sql-questions-playlist/13-infosys-sql-puzzle.md)              | [Watch Video](https://www.youtube.com/watch?v=3sd5siyCAOo)      |
| 14      | [Ameriprise - Team Members Criteria](./medium-complex-sql-questions-playlist/14-ameriprise-team-members-criteria.md) | [Watch Video](https://www.youtube.com/watch?v=KWOZ9VoVFac)      |
| 15      | [Tiger Analytics - Adult & Child Pairing](./medium-complex-sql-questions-playlist/15-tiger-analytics-adult-child-pairing.md) | [Watch Video](https://www.youtube.com/watch?v=02XLUeIVRSE)      |
| 16      | [PwC - Increase in Revenue](./medium-complex-sql-questions-playlist/16-pwc-increase-in-revenue.md)    | [Watch Video](https://www.youtube.com/watch?v=8nfzv1XI1Ic)      |
| 17      | [Spring CT - Parent-Child Names](./medium-complex-sql-questions-playlist/17-spring-ct-parent-child-names.md) | [Watch Video](https://www.youtube.com/watch?v=EsGPj8Ojk2o)      |
| 18      | [ICC World Cup Points Table](./medium-complex-sql-questions-playlist/18-icc-world-cup-points-table.md) | [Watch Video](https://www.youtube.com/watch?v=t7mkWPga8lI)      |
| 19      | [Tiger Analytics - 2 Problems](./medium-complex-sql-questions-playlist/19-tiger-analytics-2-problems.md) | [Watch Video](https://www.youtube.com/watch?v=eMQDHHfUJtU)      |
| 20      | [PwC - Source-Target Comparison](./medium-complex-sql-questions-playlist/20-pwc-source-target-comparision.md) | [Watch Video](https://www.youtube.com/watch?v=J9wwR4huimI)      |
| 21      | [Google - Repeating Words](./medium-complex-sql-questions-playlist/21-google-repeating-words.md)      | [Watch Video](https://www.youtube.com/watch?v=rTLWoTYqC-U)      |
| 22      | [Honeywell - Print Movie Stars](./medium-complex-sql-questions-playlist/22-honeywell-print-movie-stars.md) | [Watch Video](https://www.youtube.com/watch?v=CYjyjQGjX7A)      |
| 23      | [IBM - HackerRank Discounted Tours](./medium-complex-sql-questions-playlist/23-ibm-hackerrank-discounted-tours.md) | [Watch Video](https://www.youtube.com/watch?v=ORA3hvcPgTo)      |
| 24      | [Angel One - Busiest Route](./medium-complex-sql-questions-playlist/24-angel-one-busiest-route.md)   | [Watch Video](https://www.youtube.com/watch?v=rGG6FAYHDNc)      |
| 25      | [Accenture - Case Sensitivity](./medium-complex-sql-questions-playlist/25-accenture-case-sensitivity.md) | [Watch Video](https://www.youtube.com/watch?v=WmY_0shtpdg)      |
| 26      | [EXL Analytics - Max-Min Population](./medium-complex-sql-questions-playlist/26-exl-analytics-max-min-population.md) | [Watch Video](https://www.youtube.com/watch?v=WM2jN1gOs_8)      |
| 27      | [MCQ SQL Assessment](./medium-complex-sql-questions-playlist/27-mcq-sql-assessment.md)              | [Watch Video](https://www.youtube.com/watch?v=lyW5U9RNvgc)      |
| 28      | [Exchange Seats](./medium-complex-sql-questions-playlist/28-exchange-seats.md)                      | [Watch Video](https://www.youtube.com/watch?v=Sq1kM3jVU68)      |
| 29      | [Swiggy Hackerrank Assessment](./medium-complex-sql-questions-playlist/29-swiggy-hackerrank-assessment.md)                      | [Watch Video](https://www.youtube.com/watch?v=u8AKf4qvqhU)      |


---